<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FUOCO AMICO - Diego Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        :root { --brand-red: #ff3a3a; }
        body, html { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            overflow: hidden; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: sans-serif;
            touch-action: none;
        }

        /* HEADER */
        header {
            display: flex; justify-content: space-between; align-items: center;
            padding: 20px 30px; position: fixed; top: 0; width: calc(100% - 60px); 
            z-index: 100; background: rgba(255,255,255,0.1); backdrop-filter: blur(10px);
        }
        .header-item { 
            width: 60px; height: 60px; transition: 0.3s ease;
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.1));
        }
        .logo-central { width: 100px; height: 100px; }

        /* SHOP AREA */
        #shop-floor { width: 100vw; height: 100vh; position: relative; }
        .draggable-item {
            position: absolute; cursor: grab; user-select: none; 
            touch-action: none; z-index: 10;
            transition: filter 0.2s;
        }
        .draggable-item:hover { filter: brightness(1.1) drop-shadow(0 8px 16px rgba(0,0,0,0.2)); }
        .draggable-item.dragging { 
            cursor: grabbing; 
            filter: brightness(1.2) drop-shadow(0 12px 20px rgba(0,0,0,0.3));
            z-index: 100;
        }
        .draggable-item svg { width: 150px; height: 150px; pointer-events: none; }

        /* TANK ANIMATION */
        @keyframes tankGnam {
            0% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.3) rotate(-5deg); }
            50% { transform: scale(1.5) rotate(5deg); }
            75% { transform: scale(1.3) rotate(-5deg); }
            100% { transform: scale(1) rotate(0deg); }
        }
        .tank-masticando { 
            animation: tankGnam 0.6s ease-in-out;
            filter: brightness(1.3) drop-shadow(0 0 20px var(--brand-red));
        }

        /* FOOTER */
        footer { 
            position: fixed; bottom: 30px; width: 100%; 
            text-align: center; z-index: 50; 
        }
        .brand-name { 
            font-family: 'Press Start 2P', cursive;
            font-size: 24px;
            color: white;
            text-shadow: 3px 3px 0 var(--brand-red), 6px 6px 0 rgba(0,0,0,0.2);
            letter-spacing: 3px;
        }

        /* LOADING SCREEN */
        #loading-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: none; flex-direction: column; 
            justify-content: center; align-items: center; z-index: 1000;
        }
        #loading-screen.active { display: flex; }
        
        .pixel-fuochini-anim {
            width: 150px; height: 150px;
            animation: jump 0.5s infinite alternate ease-in-out;
            filter: drop-shadow(0 10px 20px rgba(255, 58, 58, 0.5));
        }
        @keyframes jump { 
            from { transform: translateY(0) scale(1); } 
            to { transform: translateY(-40px) scale(1.1); } 
        }
        
        .loading-text-pixel {
            color: white; 
            font-family: 'Press Start 2P', cursive;
            margin-top: 30px; 
            font-size: 18px; 
            animation: blink 0.8s infinite;
            text-shadow: 3px 3px 0 var(--brand-red);
        }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }
        
        .loading-bar { 
            width: 300px; height: 20px; 
            border: 4px solid white; 
            margin-top: 30px; 
            background: rgba(0,0,0,0.2);
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }
        .progress { 
            width: 0%; height: 100%; 
            background: linear-gradient(90deg, var(--brand-red), #ff6b6b);
            transition: width 3s ease-in-out;
            box-shadow: 0 0 20px var(--brand-red);
        }

        /* Particle effect */
        @keyframes particle {
            0% { transform: translate(0, 0) scale(1); opacity: 1; }
            100% { transform: translate(var(--tx), var(--ty)) scale(0); opacity: 0; }
        }
        .particle {
            position: absolute;
            width: 10px;
            height: 10px;
            background: var(--brand-red);
            border-radius: 50%;
            pointer-events: none;
            animation: particle 0.8s ease-out forwards;
        }
    </style>
</head>
<body>

    <header>
        <!-- Mondo Pongo (Globe) -->
        <svg class="header-item" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
            <circle cx="50" cy="50" r="45" fill="#4a90e2" stroke="#2c5aa0" stroke-width="3"/>
            <ellipse cx="50" cy="50" rx="45" ry="15" fill="none" stroke="#2c5aa0" stroke-width="2"/>
            <ellipse cx="50" cy="50" rx="15" ry="45" fill="none" stroke="#2c5aa0" stroke-width="2"/>
            <circle cx="50" cy="50" r="5" fill="#2c5aa0"/>
        </svg>

        <!-- Fuochini Centrali (Double Flames) -->
        <svg class="logo-central" viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg">
            <!-- Fiamma sinistra -->
            <path d="M35 80 Q35 60 40 45 Q45 30 40 15 Q45 25 50 35 Q55 45 50 60 Q48 70 35 80Z" 
                  fill="url(#flameGradient1)" stroke="#d32f2f" stroke-width="2"/>
            <!-- Fiamma destra -->
            <path d="M85 80 Q85 60 80 45 Q75 30 80 15 Q75 25 70 35 Q65 45 70 60 Q72 70 85 80Z" 
                  fill="url(#flameGradient2)" stroke="#d32f2f" stroke-width="2"/>
            <defs>
                <linearGradient id="flameGradient1" x1="0%" y1="100%" x2="0%" y2="0%">
                    <stop offset="0%" style="stop-color:#ff3a3a;stop-opacity:1" />
                    <stop offset="50%" style="stop-color:#ff6b35;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#ffaa00;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="flameGradient2" x1="0%" y1="100%" x2="0%" y2="0%">
                    <stop offset="0%" style="stop-color:#ff3a3a;stop-opacity:1" />
                    <stop offset="50%" style="stop-color:#ff6b35;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#ffaa00;stop-opacity:1" />
                </linearGradient>
            </defs>
            <animate attributeName="opacity" values="1;0.8;1" dur="1.5s" repeatCount="indefinite"/>
        </svg>

        <!-- Tank Cart -->
        <svg class="header-item" id="tank-cart" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
            <!-- Corpo del tank -->
            <rect x="20" y="40" width="60" height="30" rx="5" fill="#555" stroke="#333" stroke-width="2"/>
            <!-- Torretta -->
            <rect x="35" y="25" width="30" height="20" rx="3" fill="#666" stroke="#333" stroke-width="2"/>
            <!-- Cannone -->
            <rect x="65" y="32" width="20" height="6" rx="2" fill="#777" stroke="#333" stroke-width="1"/>
            <!-- Ruote -->
            <circle cx="30" cy="70" r="8" fill="#333" stroke="#000" stroke-width="2"/>
            <circle cx="50" cy="70" r="8" fill="#333" stroke="#000" stroke-width="2"/>
            <circle cx="70" cy="70" r="8" fill="#333" stroke="#000" stroke-width="2"/>
            <circle cx="30" cy="70" r="4" fill="#555"/>
            <circle cx="50" cy="70" r="4" fill="#555"/>
            <circle cx="70" cy="70" r="4" fill="#555"/>
        </svg>
    </header>

    <main id="shop-floor">
        <!-- Cappello -->
        <div class="draggable-item" style="top:25%; left:15%;" data-x="0" data-y="0">
            <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <ellipse cx="50" cy="70" rx="45" ry="8" fill="#1a1a1a"/>
                <path d="M20 70 Q20 40 50 30 Q80 40 80 70 Z" fill="#2c3e50" stroke="#1a1a1a" stroke-width="2"/>
                <ellipse cx="50" cy="35" rx="15" ry="8" fill="#34495e"/>
                <text x="50" y="58" font-size="20" text-anchor="middle" fill="#e74c3c" font-weight="bold">CAP</text>
            </svg>
        </div>

        <!-- T-Shirt -->
        <div class="draggable-item" style="top:35%; left:40%;" data-x="0" data-y="0">
            <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <path d="M25 30 L35 25 L35 20 Q35 15 40 15 L60 15 Q65 15 65 20 L65 25 L75 30 L70 45 L65 45 L65 85 L35 85 L35 45 L30 45 Z" 
                      fill="#e74c3c" stroke="#c0392b" stroke-width="2"/>
                <circle cx="50" cy="50" r="12" fill="white" opacity="0.3"/>
                <text x="50" y="55" font-size="12" text-anchor="middle" fill="white" font-weight="bold">TEE</text>
            </svg>
        </div>

        <!-- Jeans -->
        <div class="draggable-item" style="top:55%; left:20%;" data-x="0" data-y="0">
            <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <rect x="30" y="20" width="40" height="15" rx="2" fill="#2980b9" stroke="#1c5a85" stroke-width="2"/>
                <rect x="35" y="35" width="15" height="55" rx="3" fill="#3498db" stroke="#2980b9" stroke-width="2"/>
                <rect x="52" y="35" width="15" height="55" rx="3" fill="#3498db" stroke="#2980b9" stroke-width="2"/>
                <line x1="42.5" y1="40" x2="42.5" y2="85" stroke="#5dade2" stroke-width="1"/>
                <line x1="59.5" y1="40" x2="59.5" y2="85" stroke="#5dade2" stroke-width="1"/>
                <circle cx="50" cy="25" r="3" fill="#f39c12" stroke="#d68910" stroke-width="1"/>
                <text x="50" y="30" font-size="8" text-anchor="middle" fill="white" font-weight="bold">JEANS</text>
            </svg>
        </div>
    </main>

    <footer>
        <div class="brand-name">ðŸ”¥ FUOCO AMICO ðŸ”¥</div>
    </footer>

    <div id="loading-screen">
        <!-- Fuochini animati per loading -->
        <svg class="pixel-fuochini-anim" viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg">
            <path d="M35 80 Q35 60 40 45 Q45 30 40 15 Q45 25 50 35 Q55 45 50 60 Q48 70 35 80Z" 
                  fill="url(#loadFlame1)" stroke="#d32f2f" stroke-width="3"/>
            <path d="M85 80 Q85 60 80 45 Q75 30 80 15 Q75 25 70 35 Q65 45 70 60 Q72 70 85 80Z" 
                  fill="url(#loadFlame2)" stroke="#d32f2f" stroke-width="3"/>
            <defs>
                <linearGradient id="loadFlame1" x1="0%" y1="100%" x2="0%" y2="0%">
                    <stop offset="0%" style="stop-color:#ff3a3a;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#ffaa00;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="loadFlame2" x1="0%" y1="100%" x2="0%" y2="0%">
                    <stop offset="0%" style="stop-color:#ff3a3a;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#ffaa00;stop-opacity:1" />
                </linearGradient>
            </defs>
        </svg>
        <div class="loading-text-pixel">LOADING...</div>
        <div class="loading-bar"><div class="progress" id="bar"></div></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>
    <script>
        let isProcessing = false;

        // Crea contesto audio per il suono
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        const audioCtx = new AudioContext();

        // Funzione per creare un suono "chomp" 
        function playChompSound() {
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            oscillator.frequency.setValueAtTime(400, audioCtx.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(100, audioCtx.currentTime + 0.3);
            
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
            
            oscillator.start(audioCtx.currentTime);
            oscillator.stop(audioCtx.currentTime + 0.3);
        }

        // Funzione per creare effetto particelle
        function createParticles(x, y) {
            for (let i = 0; i < 12; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = x + 'px';
                particle.style.top = y + 'px';
                particle.style.setProperty('--tx', (Math.random() - 0.5) * 200 + 'px');
                particle.style.setProperty('--ty', (Math.random() - 0.5) * 200 + 'px');
                document.body.appendChild(particle);
                setTimeout(() => particle.remove(), 800);
            }
        }

        // Inizializza interact.js per gli elementi draggable
        interact('.draggable-item').draggable({
            listeners: {
                start(event) {
                    event.target.classList.add('dragging');
                },
                move(event) {
                    const target = event.target;
                    const x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx;
                    const y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;
                    
                    target.style.transform = `translate(${x}px, ${y}px)`;
                    target.setAttribute('data-x', x);
                    target.setAttribute('data-y', y);
                },
                end(event) {
                    event.target.classList.remove('dragging');
                }
            }
        });

        // Dropzone sul tank
        interact('#tank-cart').dropzone({
            accept: '.draggable-item',
            overlap: 0.15,
            ondrop: function (event) {
                if (isProcessing) return;
                isProcessing = true;

                const item = event.relatedTarget;
                const tank = event.target;
                const rect = item.getBoundingClientRect();
                
                // Suono!
                playChompSound();
                
                // Effetto particelle
                createParticles(rect.left + rect.width/2, rect.top + rect.height/2);
                
                // Disabilita tutti gli elementi draggable
                interact('.draggable-item').draggable(false);
                
                // Animazione dell'item che scompare
                item.style.transition = 'transform 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55), opacity 0.4s ease-out';
                item.style.transform = 'scale(0) rotate(720deg)';
                item.style.opacity = '0';
                
                // Animazione del tank
                tank.classList.add('tank-masticando');
                
                // Rimuovi l'item dal DOM e resetta il tank
                setTimeout(() => {
                    item.remove();
                    tank.classList.remove('tank-masticando');
                }, 600);
                
                // Mostra loading screen
                setTimeout(() => {
                    const loadingScreen = document.getElementById('loading-screen');
                    loadingScreen.classList.add('active');
                    
                    // Avvia la barra di progresso
                    setTimeout(() => {
                        document.getElementById('bar').style.width = '100%';
                    }, 50);
                    
                    // Reload dopo il caricamento
                    setTimeout(() => {
                        location.reload();
                    }, 3500);
                }, 700);
            }
        });

        // Abilita audio context al primo click (richiesto dai browser)
        document.addEventListener('click', () => {
            if (audioCtx.state === 'suspended') {
                audioCtx.resume();
            }
        }, { once: true });
    </script>
</body>
</html>
